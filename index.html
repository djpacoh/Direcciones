<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ordenar Direcciones</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.css" />
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Ordenar Direcciones v1.0</h1>

    <div id="excel-container">
        <h2>Insertar txt Cada Direcci√≥n en una linea 
            <button id="info-toggle" class="info-button" onclick="showHideInfo()">‚ÑπÔ∏è M√°s info</button>
        </h2>
        <div id="info-container" style="display: none; background: #e3f2fd; border: 2px solid #2196F3; border-radius: 8px; padding: 15px; margin: 15px 0;">
            <p><strong>üìÑ Ejemplo de formato correcto:</strong></p>
            <p>Cada direcci√≥n debe ir en una l√≠nea separada, como se muestra en la imagen:</p>
            <img src="txt.png" alt="Ejemplo de formato txt" style="max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 4px; margin-top: 10px;">
            <p><em>üí° Tip: Puedes usar archivos .txt, .csv, .xlsx o .xls</em></p>
        </div>
        
        <script>
        function showHideInfo() {
            console.log('Bot√≥n clickeado!');
            var container = document.getElementById('info-container');
            var button = document.getElementById('info-toggle');
            
            if (container && button) {
                console.log('Elementos encontrados');
                if (container.style.display === 'none') {
                    container.style.display = 'block';
                    button.innerHTML = '‚ùå Ocultar info';
                    button.style.backgroundColor = '#f44336';
                    console.log('Mostrando info');
                } else {
                    container.style.display = 'none';
                    button.innerHTML = '‚ÑπÔ∏è M√°s info';
                    button.style.backgroundColor = '#2196F3';
                    console.log('Ocultando info');
                }
            } else {
                console.error('No se encontraron elementos');
            }
        }
        </script>
        <input type="file" id="excel-file" accept=".xlsx, .xls, .txt, .csv">
        <input type="number" id="zone-count" placeholder="N√∫mero de zonas" value=" " min="1" max="500">
        <input type="number" id="max-addresses-per-zone" placeholder="M√°ximo de direcciones por zona" value=" " min="2" max="5000">
        <input type="number" id="min-addresses-per-zone" placeholder="M√≠nimo de direcciones por zona" value=" " min="1" max="1000">
        <button id="read-excel">Leer Archivo</button>
        
        <!-- Preview container -->
        <div id="preview-container" style="display: none;">
            <h3>Direcciones encontradas en el archivo:</h3>
            <div id="preview-info">
                <span id="total-addresses">0</span> direcciones detectadas
            </div>
            <div id="address-preview" style="max-height: 300px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; margin: 10px 0;">
                <!-- Las direcciones aparecer√°n aqu√≠ -->
            </div>
            <div style="margin-top: 10px;">
                <button id="process-excel" style="background-color: #4CAF50;">Procesar y Agrupar</button>
                <button id="cancel-process" style="background-color: #f44336; margin-left: 10px;">Cancelar</button>
            </div>
        </div>
        
        <!-- Progress container -->
        <div id="progress-container" style="display: none;">
            <div id="progress-text">Procesando...</div>
            <div id="progress-bar">
                <div id="progress-fill"></div>
            </div>
            <div id="progress-percentage">0%</div>
        </div>
    </div>

    <hr>

    <div id="manual-container">
        <h2>Ruta Optimizada Manual</h2>
        <div class="address-input-wrapper">
            <input type="text" id="base-address" placeholder="Direcci√≥n base">
            <button class="mic-button" data-target="base-address">üé§</button>
        </div>
        <div id="address-list-container">
            <div class="address-input-wrapper">
                <input type="text" class="address-input" placeholder="A√±adir direcci√≥n">
                <button class="mic-button" data-target-class="address-input">üé§</button>
            </div>
        </div>
        <button id="add-address">A√±adir otra direcci√≥n</button>
        <button id="sort-addresses">Ordenar</button>
        <button id="toggle-map">Minimizar/Maximizar Mapa</button>
    </div>

    <div id="map"></div>
    <div id="output-container">
        <h2>Resultados</h2>
        <ul id="sorted-addresses"></ul>
    </div>

    <!-- Panel de edici√≥n de zona -->
    <div id="zone-editor-overlay" style="display: none;">
        <div id="zone-editor-modal">
            <div class="zone-editor-header">
                <h3 id="zone-editor-title">Editar Zona</h3>
                <button id="zone-editor-close" class="close-button">√ó</button>
            </div>
            <div class="zone-editor-content">
                <div class="zone-editor-info">
                    <div id="zone-editor-stats"></div>
                </div>
                <div class="zone-editor-addresses">
                    <h4>Direcciones en esta zona:</h4>
                    <div id="zone-editor-list"></div>
                </div>
                <div class="zone-editor-actions">
                    <button id="zone-editor-save" class="save-button">üíæ Guardar Cambios</button>
                    <button id="zone-editor-cancel" class="cancel-button">‚ùå Cancelar</button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>
    <script src="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.js"></script>
    <script src="xlsx.full.min.js"></script>
    <script src="script.js"></script>

</body>
</html>